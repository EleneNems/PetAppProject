<app-loading-spinner [loading]="loading" message="Loading Your Pets..."> </app-loading-spinner>

<div class="container">
  <div class="deco-animals">
    <svg class="deco-bunny" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="65" rx="25" ry="30" fill="var(--primary-pink)" opacity="0.15" />
      <ellipse cx="35" cy="35" rx="8" ry="20" fill="var(--primary-pink)" opacity="0.15" />
      <ellipse cx="65" cy="35" rx="8" ry="20" fill="var(--primary-pink)" opacity="0.15" />
      <circle cx="45" cy="65" r="3" fill="var(--primary-pink)" opacity="0.2" />
      <circle cx="55" cy="65" r="3" fill="var(--primary-pink)" opacity="0.2" />
    </svg>

    <svg class="deco-cat" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="60" rx="28" ry="25" fill="var(--secondary-cyan)" opacity="0.15" />
      <path d="M 25 45 L 35 25 L 45 45 Z" fill="var(--secondary-cyan)" opacity="0.15" />
      <path d="M 75 45 L 65 25 L 55 45 Z" fill="var(--secondary-cyan)" opacity="0.15" />
      <circle cx="42" cy="58" r="3" fill="var(--secondary-cyan)" opacity="0.2" />
      <circle cx="58" cy="58" r="3" fill="var(--secondary-cyan)" opacity="0.2" />
    </svg>

    <svg class="deco-dog" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="60" rx="30" ry="28" fill="var(--accent-yellow)" opacity="0.15" />
      <ellipse cx="30" cy="50" rx="12" ry="18" fill="var(--accent-yellow)" opacity="0.15" />
      <ellipse cx="70" cy="50" rx="12" ry="18" fill="var(--accent-yellow)" opacity="0.15" />
      <circle cx="43" cy="60" r="3" fill="var(--accent-yellow)" opacity="0.2" />
      <circle cx="57" cy="60" r="3" fill="var(--accent-yellow)" opacity="0.2" />
    </svg>
  </div>

  <div class="page-header">
    <div class="header-icon-wrapper">
      <svg viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
        <ellipse
          cx="30"
          cy="35"
          rx="15"
          ry="12"
          fill="none"
          stroke="var(--primary-pink)"
          stroke-width="2.5"
        />
        <circle cx="25" cy="33" r="2" fill="var(--primary-pink)" />
        <circle cx="35" cy="33" r="2" fill="var(--primary-pink)" />
        <ellipse
          cx="20"
          cy="25"
          rx="5"
          ry="8"
          fill="none"
          stroke="var(--primary-pink)"
          stroke-width="2"
        />
        <ellipse
          cx="40"
          cy="25"
          rx="5"
          ry="8"
          fill="none"
          stroke="var(--primary-pink)"
          stroke-width="2"
        />
      </svg>
      <div class="icon-glow"></div>
    </div>
    <h1 class="page-title">Pet Management</h1>
    <p>Add, edit, and manage your adorable companions</p>

    <div class="subtitle-section">
      <div class="subtitle-line"></div>
      <p class="subtitle-text">Create & Customize</p>
      <div class="subtitle-line"></div>
    </div>
  </div>

  <div class="form-section">
    <div class="section-header-admin">
      <div class="header-decoration-admin"></div>
      <h2>{{ editingPet ? 'Edit Pet' : 'Add New Pet' }}</h2>
      <div class="header-decoration-admin"></div>
    </div>

    <form
      (ngSubmit)="editingPet ? updatePet() : submitPet()"
      [formGroup]="petForm"
      enctype="multipart/form-data"
      class="pet-form"
    >
      <div class="form-grid">
        <!-- Pet Name -->
        <div class="form-group">
          <label>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <circle
                cx="12"
                cy="10"
                r="3"
                fill="none"
                stroke="var(--primary-pink)"
                stroke-width="2"
              />
              <path
                d="M 6 20 Q 6 15 12 15 Q 18 15 18 20"
                fill="none"
                stroke="var(--primary-pink)"
                stroke-width="2"
              />
            </svg>
            Pet Name
          </label>
          <input formControlName="name" placeholder="Enter pet name..." />
          <div class="input-glow"></div>
        </div>

        <!-- Species -->
        <div class="form-group">
          <label>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <ellipse
                cx="12"
                cy="14"
                rx="6"
                ry="5"
                fill="none"
                stroke="var(--secondary-cyan)"
                stroke-width="2"
              />
              <circle cx="10" cy="13" r="1" fill="var(--secondary-cyan)" />
              <circle cx="14" cy="13" r="1" fill="var(--secondary-cyan)" />
              <ellipse
                cx="8"
                cy="9"
                rx="2"
                ry="3"
                fill="none"
                stroke="var(--secondary-cyan)"
                stroke-width="1.5"
              />
              <ellipse
                cx="16"
                cy="9"
                rx="2"
                ry="3"
                fill="none"
                stroke="var(--secondary-cyan)"
                stroke-width="1.5"
              />
            </svg>
            Species
          </label>
          <input formControlName="species" placeholder="Enter species..." />
          <div class="input-glow"></div>
        </div>

        <!-- Pet Description -->
        <div class="form-group full-width">
          <label>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 6h16v12H4z" fill="none" stroke="var(--accent-purple)" stroke-width="2" />
              <path d="M6 10h12M6 14h8" stroke="var(--accent-purple)" stroke-width="2" />
            </svg>
            Description
          </label>
          <textarea
            formControlName="description"
            placeholder="Enter a short description for the pet..."
          ></textarea>
          <div class="input-glow"></div>
        </div>

        <!-- Pet Image -->
        <div class="form-group full-width">
          <label>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <rect
                x="4"
                y="4"
                width="16"
                height="16"
                rx="2"
                fill="none"
                stroke="var(--accent-yellow)"
                stroke-width="2"
              />
              <circle cx="9" cy="9" r="2" fill="var(--accent-yellow)" />
              <path
                d="M 4 16 L 8 12 L 12 16 L 16 10 L 20 14"
                fill="none"
                stroke="var(--accent-yellow)"
                stroke-width="2"
              />
            </svg>
            Pet Image
          </label>
          <div class="file-input-wrapper">
            <input type="file" (change)="onFileSelected($event)" id="file-input" />
            <label for="file-input" class="file-label">
              <span class="file-icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M 12 4 L 12 16 M 8 12 L 12 16 L 16 12"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M 4 18 L 4 20 L 20 20 L 20 18"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                    stroke-linecap="round"
                  />
                </svg>
              </span>
              <span class="file-text">{{
                selectedFile ? selectedFile.name : 'Choose file...'
              }}</span>
            </label>
          </div>
          <div class="input-glow"></div>
        </div>
      </div>

      <!-- Form actions remain unchanged -->
      <div class="form-actions">
        <button type="submit" class="btn btn-primary">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M 5 13 L 9 17 L 19 7"
              stroke="currentColor"
              stroke-width="2"
              fill="none"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <span>{{ editingPet ? 'Update Pet' : 'Upload Pet' }}</span>
        </button>

        <button *ngIf="editingPet" type="button" (click)="cancelEdit()" class="btn btn-secondary">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M 6 6 L 18 18 M 18 6 L 6 18"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
          <span>Cancel</span>
        </button>
      </div>

      <p *ngIf="message" class="message-alert" [class.success]="message.includes('success')">
        {{ message }}
      </p>
    </form>
  </div>

  <div class="pet-list-section">
    <div class="section-header-admin">
      <div class="header-decoration-admin"></div>
      <h2>Manage Pets</h2>
      <div class="header-decoration-admin"></div>
    </div>

    <div class="pet-grid">
      <div class="pet-card" *ngFor="let pet of pets">
        <div class="pet-image-wrapper">
          <img [src]="pet.image_url" [alt]="pet.name" />
          <div class="pet-image-overlay"></div>
        </div>
        <div class="pet-info">
          <h4>{{ pet.name }}</h4>
          <p class="pet-species">{{ pet.species }}</p>
        </div>
        <div class="pet-actions">
          <button (click)="editPet(pet)" class="btn-icon btn-edit">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M 17 3 L 21 7 L 9 19 L 3 21 L 5 15 Z"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linejoin="round"
              />
              <path d="M 15 5 L 19 9" stroke="currentColor" stroke-width="2" />
            </svg>
          </button>
          <button (click)="confirmDelete(pet.id)" class="btn-icon btn-delete">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M 3 6 L 21 6 M 8 6 L 8 4 Q 8 3 9 3 L 15 3 Q 16 3 16 4 L 16 6"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M 10 11 L 10 17 M 14 11 L 14 17"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M 5 6 L 6 19 Q 6 21 8 21 L 16 21 Q 18 21 18 19 L 19 6"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-overlay" *ngIf="showDeleteModal">
    <div class="modal-window">
      <div class="modal-icon">
        <svg viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
          <circle
            cx="30"
            cy="30"
            r="25"
            fill="none"
            stroke="var(--primary-pink)"
            stroke-width="3"
          />
          <path
            d="M 30 15 L 30 32"
            stroke="var(--primary-pink)"
            stroke-width="3"
            stroke-linecap="round"
          />
          <circle cx="30" cy="40" r="2" fill="var(--primary-pink)" />
        </svg>
      </div>
      <h3>Confirm Deletion</h3>
      <p>Are you sure you want to delete this pet? This action cannot be undone.</p>
      <div class="modal-buttons">
        <button (click)="deleteConfirmed()" class="btn btn-danger">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M 5 13 L 9 17 L 19 7"
              stroke="currentColor"
              stroke-width="2"
              fill="none"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          Yes, Delete
        </button>
        <button (click)="cancelDelete()" class="btn btn-secondary">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M 6 6 L 18 18 M 18 6 L 6 18"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
